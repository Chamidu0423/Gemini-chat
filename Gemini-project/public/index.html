<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini AI Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'purple': {
                            400: '#c084fc',
                            500: '#a855f7',
                            600: '#9333ea',
                            700: '#7e22ce'
                        },
                        'pink': {
                            400: '#f472b6',
                            500: '#ec4899',
                            600: '#db2777',
                            700: '#be185d'
                        },
                        'blue': {
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: #000 !important;
        }
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        .splash-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }
        .main-content {
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }
        .main-content.visible {
            opacity: 1;
        }
        .glass {
            background: rgba(20, 20, 20, 0.7);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.08);
        }
        .glass-input {
            background: rgba(20, 20, 20, 0.8) !important;
            color: #fff !important;
            border: 1px solid rgba(255,255,255,0.12) !important;
        }
        .glass-message {
            background: rgba(30, 30, 30, 0.7) !important;
            border: 1px solid rgba(255,255,255,0.10) !important;
            color: #fff !important;
        }
        .glass-user {
            background: rgba(40, 40, 40, 0.8) !important;
            border: 1px solid rgba(255,255,255,0.12) !important;
            color: #fff !important;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-900 via-blue-900 to-purple-900 text-white min-h-screen">
    <!-- Splash Screen -->
    <div id="splash-screen" class="splash-screen">
        <img src="/src/Ai.gif" alt="AI Avatar" class="w-32 h-32 rounded-full object-cover">
    </div>

    <div id="main-content" class="main-content w-full h-full min-h-screen flex flex-col">
        <!-- Main Chat Container -->
        <div class="flex-1 flex flex-col glass overflow-hidden rounded-none">
            <!-- Messages Area -->
            <div id="messages" class="flex-1 overflow-y-auto p-6 space-y-6">
                <div class="flex flex-col items-center justify-center h-full text-center space-y-4" id="welcome-message">
                    <div class="p-4 rounded-full" style="background: #000; border: 2px solid #222; box-shadow: 0 0 40px 8px #1e40af, 0 0 0 4px #000 inset;">
                        <img src="/src/Ai.gif" alt="AI Avatar" class="w-12 h-12 rounded-full object-cover">
                    </div>
                    <h2 class="text-2xl font-semibold text-white">Hello, I'm an Artifical Intelligence</h2>
                    <p class="text-gray-300 max-w-md">
                        Ask me anything - I'm powered by Google's Intellisense and ready to help with your questions
                    </p>
                </div>
            </div>
            <!-- Input Area -->
            <div class="border-t p-4 glass">
                <form id="chat-form" class="flex gap-4">
                    <input
                        type="text"
                        id="message-input"
                        placeholder="Type your message..."
                        class="flex-1 glass-input rounded-3xl px-6 py-4 placeholder-gray-400 text-white focus:outline-none focus:ring-2 focus:ring-white transition-all"
                    />
                    <button
                        type="submit"
                        class="glass rounded-xl px-6 py-4 font-medium text-white hover:bg-opacity-80 focus:outline-none focus:ring-0 focus:border-none disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg" style="border:none;"
                    >
                        <svg class="w-6 h-6 transform rotate-45" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m22 2-7 20-4-9-9-4Z"/>
                            <path d="M22 2 11 13"/>
                        </svg>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        const splashScreen = document.getElementById('splash-screen');
        const mainContent = document.getElementById('main-content');

        setTimeout(() => {
            splashScreen.classList.add('fade-out');
            mainContent.classList.add('visible');
            setTimeout(() => {
                splashScreen.style.display = 'none';
            }, 500);
        }, 2000);

        const messagesContainer = document.getElementById('messages');
        const welcomeMessage = document.getElementById('welcome-message');
        const chatForm = document.getElementById('chat-form');
        const messageInput = document.getElementById('message-input');
        let isFirstMessage = true;

        function createMessageElement(content, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex items-start gap-4 ${isUser ? 'flex-row-reverse' : ''}`;
            const iconDiv = document.createElement('div');
            iconDiv.className = `flex-shrink-0 rounded-full p-2 glass`;
            const icon = isUser ? `
                <svg class="w-6 h-6 text-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
            ` : `
                <img src="/src/Ai.gif" alt="AI Avatar" class="w-6 h-6 rounded-full object-cover">
            `;
            iconDiv.innerHTML = icon;
            const contentDiv = document.createElement('div');
            contentDiv.className = `flex-1 rounded-2xl px-6 py-4 ${isUser ? 'glass-user ml-12' : 'glass-message mr-12'}`;
            const text = document.createElement('p');
            text.className = 'whitespace-pre-wrap text-white';
            text.textContent = content;
            contentDiv.appendChild(text);
            messageDiv.appendChild(iconDiv);
            messageDiv.appendChild(contentDiv);
            return messageDiv;
        }

        function createLoadingMessage() {
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'flex items-start gap-4';
            loadingDiv.innerHTML = `
                <div class="flex-shrink-0 rounded-full p-2 bg-gradient-to-r from-blue-500/30 to-purple-500/30 border border-blue-500/30">
                    <img src="/src/Ai.gif" alt="AI Avatar" class="w-6 h-6 rounded-full object-cover">
                </div>
                <div class="flex-1 rounded-2xl px-6 py-4 bg-gradient-to-r from-blue-500/30 to-purple-500/30 border border-blue-500/30 mr-12">
                    <svg class="w-6 h-6 animate-spin text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
                    </svg>
                </div>
            `;
            return loadingDiv;
        }

        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const message = messageInput.value.trim();
            if (!message) return;

            if (isFirstMessage) {
                welcomeMessage.remove();
                isFirstMessage = false;
            }

            messageInput.value = '';
            messageInput.disabled = true;

            messagesContainer.appendChild(createMessageElement(message, true));
            
            const loadingMessage = createLoadingMessage();
            messagesContainer.appendChild(loadingMessage);
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            try {
                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message }),
                });

                const data = await response.json();
                
                loadingMessage.remove();
                if (!data.response || data.response.trim() === "") {
                    messagesContainer.appendChild(
                        createMessageElement('AI did not respond due to missing API key, network error, or another issue.', false)
                    );
                } else {
                    messagesContainer.appendChild(createMessageElement(data.response, false));
                }
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            } catch (error) {
                    console.error('Error:', error);
                    loadingMessage.remove();
                    messagesContainer.appendChild(
                        createMessageElement('AI did not respond due to missing API key, network error, or another issue.', false)
                    );
            }

            messageInput.disabled = false;
            messageInput.focus();
        });
    </script>
</body>
</html>